(this["webpackJsonpmy-react-app"]=this["webpackJsonpmy-react-app"]||[]).push([[0],{179:function(t,e,a){t.exports=a(370)},184:function(t,e,a){},185:function(t,e,a){},370:function(t,e,a){"use strict";a.r(e);var n=a(0),o=a.n(n),r=a(31),l=a.n(r),c=(a(184),a(9)),s=a(10),i=a(12),u=a(11),p=a(13),h=(a(185),"Tpk_391653b184fb45f2a8e9b1270c0306e9"),d="https://sandbox.iexapis.com/stable/stock/market/batch?";var f=function(t,e,a){return function(t,e,a){var n=d;n+="symbols=";for(var o=0;o<t.length;o++)n+=t[o],o<t.length-1&&(n+=",");return n+="&types="+e,e.includes("chart")&&(n+=a?"&range="+a:"&range=1y"),n+="&token="+h}(t,e,a)};var m=function(t){return function(t){var e=JSON.parse(localStorage.getItem(t));if(!e)throw new Error("Did not find '"+t+"' in local storage");return e}(t)},v=function(t,e){return function(t,e){localStorage.setItem(e,JSON.stringify(t))}(t,e)},y=function(t){function e(){return Object(c.a)(this,e),Object(i.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(s.a)(e,[{key:"render",value:function(){return o.a.createElement("button",null,"Add Portfolio")}}]),e}(o.a.Component),g=function(t){function e(){return Object(c.a)(this,e),Object(i.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(s.a)(e,[{key:"render",value:function(){var t=this.props.stock,e=this.props.stockInfo,a=this.props.showInEuro,n=e.quote.latestPrice,r=e.purchase.shares,l=e.purchase.price,c=e.purchase.currency;return o.a.createElement("tr",null,o.a.createElement("td",null,t),o.a.createElement("td",null,n," ",a?"EUR":"USD"),o.a.createElement("td",null,l," ",c),o.a.createElement("td",null,r),o.a.createElement("td",null,String((n*r).toFixed(3))," ",a?"EUR":"USD"),o.a.createElement("td",null,o.a.createElement("input",{type:"checkbox"})))}}]),e}(o.a.Component),D=a(20),E=function(t){function e(){return Object(c.a)(this,e),Object(i.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(s.a)(e,[{key:"generateHslColor",value:function(){return"hsl("+(360*Math.random()).toFixed(0).toString()+",40%,70%)"}},{key:"graphRangeToDate",value:function(t){if(t.includes("d")){var e=t.replace("d",""),a=new Date;return new Date((new Date).setDate(a.getDate()-e))}if(t.includes("m")){var n=t.replace("m",""),o=new Date;return new Date((new Date).setMonth(o.getMonth()-n))}if(t.includes("ytd"))return new Date((new Date).toISOString().slice(0,4));if(t.includes("y")){var r=t.replace("y",""),l=new Date;return new Date((new Date).setFullYear(l.getFullYear()-r))}if(t.includes("max")){var c=new Date;return new Date((new Date).setFullYear(c.getFullYear()-500))}}},{key:"render",value:function(){var t=this,e=this.props.stocks,a=this.props.graphRange,n=[],r=[],l=this.graphRangeToDate(a);for(var c in e)if(e.hasOwnProperty(c)){r.push(c);var s=e[c].chart,i=0;for(var u in s)if(s.hasOwnProperty(u)){var p=s[u].date,h=s[u].close;if(new Date(p)>=l){if(i in n){var d=n[i];d[c]=h,n[i]=d}else{var f={};f.name=p,f[c]=h,n.push(f)}i++}}}return(o.a.createElement("div",null,o.a.createElement(D.e,{aspect:1.7,width:500},o.a.createElement(D.d,{width:"100%",height:"100%",data:n,margin:{top:5,right:30,left:20,bottom:5}},o.a.createElement(D.a,{strokeDasharray:"3 3"}),o.a.createElement(D.g,{dataKey:"name"}),o.a.createElement(D.h,null),o.a.createElement(D.f,null),o.a.createElement(D.b,null),r.map((function(e){return o.a.createElement(D.c,{key:e,type:"monotone",dataKey:e,stroke:t.generateHslColor(),activeDot:{r:4},dot:!1})}))))))}}]),e}(o.a.PureComponent),b=function(t){function e(){return Object(c.a)(this,e),Object(i.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(s.a)(e,[{key:"render",value:function(){this.props.selections;return o.a.createElement("button",null,"Remove selected stocks")}}]),e}(o.a.Component),k=function(t){function e(t){var a;return Object(c.a)(this,e),(a=Object(i.a)(this,Object(u.a)(e).call(this,t))).state={selections:null},a}return Object(p.a)(e,t),Object(s.a)(e,[{key:"render",value:function(){var t=this.props.stocks,e=this.props.showInEuro,a=[];for(var n in t)t.hasOwnProperty(n)&&a.push(o.a.createElement(g,{key:n,stock:n,stockInfo:t[n],showInEuro:e}));return o.a.createElement("div",null,o.a.createElement(b,{selections:this.state.selections}),o.a.createElement("table",null,o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null,"Stock"),o.a.createElement("th",null,"Latest Price"),o.a.createElement("th",null,"Purchase Price"),o.a.createElement("th",null,"Shares"),o.a.createElement("th",null,"Total"),o.a.createElement("th",null,"Select"))),o.a.createElement("tbody",null,a)))}}]),e}(o.a.Component),O=[{value:"5d",text:"5 days"},{value:"1m",text:"1 month"},{value:"3m",text:"3 months"},{value:"6m",text:"6 months"},{value:"ytd",text:"This year"},{value:"1y",text:"1 year"},{value:"2y",text:"2 years"},{value:"5y",text:"5 years"},{value:"max",text:"Maximum available"}],w=function(t){function e(){return Object(c.a)(this,e),Object(i.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(s.a)(e,[{key:"render",value:function(){var t=this.props.name,e=this.props.portfolio.stocks,a=this.props.portfolio.userPrefs.showInEuro,n=this.props.portfolio.userPrefs.graphRange;return o.a.createElement("div",null,o.a.createElement("h2",null,t),o.a.createElement("button",null,a?"USD":"EUR"),o.a.createElement("div",null,o.a.createElement(E,{stocks:e,graphRange:n}),o.a.createElement("select",{defaultValue:n},O.map((function(t){return o.a.createElement("option",{key:t.value,value:t.value},t.value)})))),o.a.createElement("button",null,"Add stock"),o.a.createElement(k,{stocks:e,showInEuro:a}),o.a.createElement("button",null,"Remove portfolio"))}}]),e}(o.a.Component),S=function(t){function e(t){var a;return Object(c.a)(this,e),(a=Object(i.a)(this,Object(u.a)(e).call(this,t))).state={appData:{},loading:!1},a}return Object(p.a)(e,t),Object(s.a)(e,[{key:"dataFetcher",value:function(t,e,a){var n=this,o=f(t,e,a);return fetch(o).then((function(t){if(t.ok)return t.json();throw new Error("Error while fetching from api...")})).then((function(t){return t})).catch((function(t){return n.setState({error:t})}))}},{key:"addEmptyPortfolio",value:function(t){var e=this,a=this.state.appData;a[t]={},this.setState({appData:a},(function(){console.log("==> new empty portfolio added"),console.log("==> Saving to local storage"),v(e.state.appData,"appData")}))}},{key:"addEmptyStock",value:function(t,e){var a=this,n=this.state.appData;n[t][e]={},this.setState({appData:n},(function(){console.log("==> new empty stock added"),console.log("==> Saving to local storage"),v(a.state.appData,"appData")}))}},{key:"addEmptyChart",value:function(t,e){var a=this,n=this.state.appData;n[t][e].chart=[],this.setState({appData:n},(function(){console.log("==> new empty chart added"),console.log("==> Saving to local storage"),v(a.state.appData,"appData")}))}},{key:"addChartElement",value:function(t,e,a){var n=this,o=this.state.appData;o[t][e].chart.push(a),this.setState({appData:o},(function(){console.log("==> new chart element added"),console.log("==> Saving to local storage"),v(n.state.appData,"appData")}))}},{key:"addQuote",value:function(t,e,a){var n=this,o=this.state.appData;o[t][e].quote=a,this.setState({appData:o},(function(){console.log("==> new quote added"),console.log("==> Saving to local storage"),v(n.state.appData,"appData")}))}},{key:"addPurchase",value:function(t,e,a){var n=this,o=this.state.appData;o[t][e].purchase=a,this.setState({appData:o},(function(){console.log("==> new purchase added"),console.log("==> Saving to local storage"),v(n.state.appData,"appData")}))}},{key:"addDummyPurchase",value:function(t){var e=this.state.appData[t];for(var a in e)if(e.hasOwnProperty(a)){this.addPurchase(t,a,{date:"1970-01-01",price:10,shares:10})}}},{key:"appendPortfolio",value:function(t,e){var a=this,n=this.state.appData;n[t]=e,this.setState({appData:n},(function(){console.log("==> appended portfolio"),console.log("==> Saving to local storage"),v(a.state.appData,"appData")}))}},{key:"createAndAppendDummyPortfolio",value:function(t,e,a,n){var o=this;console.log("==> Creating dummy portfolio '"+t+"'"),this.dataFetcher(e,a,n).then((function(e){for(var a in e)e.hasOwnProperty(a)&&(e[a].purchase={date:"1970-01-01",price:10,shares:7,currency:"USD"});var n=o.state.appData;n[t]={stocks:e},n[t].userPrefs={showInEuro:!1,graphRange:"6m"},o.setState({appData:n},(function(){console.log("==> State set. Dummy purchase data added to"+t),v(o.state.appData,"appData")}))}))}},{key:"refreshPortfolio",value:function(t){var e=this;console.log("==> Refreshing portfolio data '"+t+"'");var a=this.state.appData,n=Object.keys(a[t].stocks);this.dataFetcher(n,"quote,chart","5d").then((function(n){for(var o in n)n.hasOwnProperty(o)&&(a[t].stocks[o].chart=n[o].chart);console.log("==> Refreshed portfolio:",a[t]),e.setState({appData:a},(function(){console.log("==> Set state with newStockData and range 5d !!!!!!!!!!!!!!!!"),v(e.state.appData,"appData")}))}))}},{key:"componentDidMount",value:function(){var t=this;try{var e=m("appData");this.setState({appData:e},(function(){console.log("==> State set. Loaded 'portfolios' and 'appData' from local storage"),console.log("==> appData:",t.state.appData)}))}catch(a){console.log("==>",a),console.log("==> Creating dummy data"),this.createAndAppendDummyPortfolio("My Big Portfolio",["AAPL","GOOGL","TWTR","FB"],"quote,chart","max"),this.createAndAppendDummyPortfolio("My Big Portfolio 2",["AAPL","GOOGL","TWTR","FB"],"quote,chart","max"),this.createAndAppendDummyPortfolio("My Big Portfolio 3",["AAPL","GOOGL","TWTR","FB"],"quote,chart","max")}}},{key:"render",value:function(){console.log("==> App render");var t=this.state.appData,e=[];for(var a in t)t.hasOwnProperty(a)&&e.push(a);return o.a.createElement("div",{className:"App"},o.a.createElement("h1",null,"SPMS"),o.a.createElement("a",{href:"https://iexcloud.io"},"Data provided by IEX Cloud"),o.a.createElement("p",null,"15 minute delay in price"),o.a.createElement(y,null),e.map((function(e){return o.a.createElement(w,{key:e,name:e,portfolio:t[e]})})))}}]),e}(o.a.Component);l.a.render(o.a.createElement(S,null),document.getElementById("root"))}},[[179,1,2]]]);
//# sourceMappingURL=main.2603fadf.chunk.js.map